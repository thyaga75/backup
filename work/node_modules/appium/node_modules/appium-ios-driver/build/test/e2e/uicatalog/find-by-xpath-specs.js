'use strict';

var _regeneratorRuntime = require('babel-runtime/regenerator')['default'];

var _interopRequireDefault = require('babel-runtime/helpers/interop-require-default')['default'];

var _setupBase = require("../setup-base");

var _setupBase2 = _interopRequireDefault(_setupBase);

var _desired = require('./desired');

var _desired2 = _interopRequireDefault(_desired);

var _bluebird = require('bluebird');

var _bluebird2 = _interopRequireDefault(_bluebird);

var _lodash = require('lodash');

var _lodash2 = _interopRequireDefault(_lodash);

var _helpersRecipesJs = require('../helpers/recipes.js');

describe('uicatalog - find by xpath', function () {
  var session = (0, _setupBase2['default'])(this, _desired2['default']);
  var driver = session.driver;

  describe('individual calls', function () {
    var _this = this;

    beforeEach(function callee$2$0() {
      var el;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('xpath', "//UIAStaticText[contains(@label,'Buttons')]"));

          case 2:
            el = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.click(el));

          case 5:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });

    afterEach(function callee$2$0() {
      var el;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('accessibility id', 'UICatalog'));

          case 2:
            el = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.click(el));

          case 5:
            context$3$0.next = 7;
            return _regeneratorRuntime.awrap(_bluebird2['default'].delay(1000));

          case 7:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });

    it('should return the last button', function callee$2$0() {
      var el;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('xpath', "//UIAButton[last()]"));

          case 2:
            el = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.getText(el));

          case 5:
            context$3$0.sent.should.equal("Button");

          case 6:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });

    // this is the name of the last button
    it('should return a single element', function callee$2$0() {
      var el;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('xpath', "//UIAButton"));

          case 2:
            el = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.getText(el));

          case 5:
            context$3$0.sent.should.equal("UICatalog");

          case 6:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });

    it('should return multiple elements', function callee$2$0() {
      var els;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElements('xpath', "//UIAButton"));

          case 2:
            els = context$3$0.sent;

            els.should.have.length.above(5);

          case 4:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });

    it('should filter by name', function callee$2$0() {
      var el;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('xpath', "//UIAButton[@name='X Button']"));

          case 2:
            el = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.getText(el));

          case 5:
            context$3$0.sent.should.equal("X Button");

          case 6:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });

    it('should know how to restrict root-level elements', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(_bluebird2['default'].resolve(driver.findElement('xpath', "/UIAButton"))['catch'](_helpersRecipesJs.throwMatchableError).should.be.rejectedWith(/jsonwpCode: 7/));

          case 2:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });

    it('should search an extended path by child', function callee$2$0() {
      var el;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('xpath', "//UIANavigationBar/UIAStaticText"));

          case 2:
            el = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.getText(el));

          case 5:
            context$3$0.sent.should.equal('Buttons');

          case 6:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });

    it('should search an extended path by descendant', function callee$2$0() {
      var els, texts;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElements('xpath', "//UIATableCell//UIAButton"));

          case 2:
            els = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(_bluebird2['default'].all(_lodash2['default'].map(els, function (el) {
              return driver.getText(el);
            })));

          case 5:
            texts = context$3$0.sent;

            texts.should.not.include("UICatalog");
            texts.should.include("X Button");

          case 8:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });

    it('should filter by indices', function callee$2$0() {
      var el;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.implicitWait(10000));

          case 2:
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(driver.findElement('xpath', "//UIATableCell[4]/UIAButton[1]"));

          case 4:
            el = context$3$0.sent;
            context$3$0.next = 7;
            return _regeneratorRuntime.awrap(driver.getAttribute('name', el));

          case 7:
            context$3$0.sent.should.equal('X Button');

          case 8:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });

    it('should filter by partial text', function callee$2$0() {
      var el;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('xpath', "//UIATableCell//UIAButton[contains(@name, 'X ')]"));

          case 2:
            el = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.getText(el));

          case 5:
            context$3$0.sent.should.equal("X Button");

          case 6:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });
  });

  describe('duplicate text field', function () {
    var _this2 = this;

    beforeEach(function callee$2$0() {
      var el;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('accessibility id', 'Text Fields'));

          case 2:
            el = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.click(el));

          case 5:
            context$3$0.next = 7;
            return _regeneratorRuntime.awrap(_bluebird2['default'].delay(2000));

          case 7:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this2);
    });

    afterEach(function callee$2$0() {
      var el;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('accessibility id', 'UICatalog'));

          case 2:
            el = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.click(el));

          case 5:
            context$3$0.next = 7;
            return _regeneratorRuntime.awrap(_bluebird2['default'].delay(1000));

          case 7:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this2);
    });

    it('should find only one text field', function callee$2$0() {
      var els;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElements('xpath', '//UIATableView["Empty list"]/UIATableCell[1]/UIATextField'));

          case 2:
            els = context$3$0.sent;

            els.should.have.length(1);

          case 4:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this2);
    });

    it('should find only one text field when doing relative search', function callee$2$0() {
      var el2, els;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('xpath', '//UIATableView["Empty list"]'));

          case 2:
            el2 = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.findElementsFromElement('xpath', '//UIATableCell[1]/UIATextField', el2));

          case 5:
            els = context$3$0.sent;

            els.should.have.length(1);

          case 7:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this2);
    });

    it('should find only one secure text field', function callee$2$0() {
      var els;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElements('xpath', '//UIATableView["Empty list"]/UIATableCell[3]/UIASecureTextField'));

          case 2:
            els = context$3$0.sent;

            els.should.have.length(1);

          case 4:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this2);
    });
  });

  describe('multiple calls', function () {
    var runs = 5;

    var test = function test(path, minLength) {
      return function () {
        var _this3 = this;

        it('should not crash', function callee$4$0() {
          var els;
          return _regeneratorRuntime.async(function callee$4$0$(context$5$0) {
            while (1) switch (context$5$0.prev = context$5$0.next) {
              case 0:
                context$5$0.next = 2;
                return _regeneratorRuntime.awrap(driver.findElements('xpath', path));

              case 2:
                els = context$5$0.sent;

                els.should.have.length.above(minLength);

              case 4:
              case 'end':
                return context$5$0.stop();
            }
          }, null, _this3);
        });
      };
    };

    describe('finding specific path', function () {
      for (var n = 0; n < runs; n++) {
        describe('test ' + (n + 1), test("//UIAApplication[1]/UIAWindow/UIATableView/UIATableCell", 17));
      }
    });

    describe('finding //*', function () {
      for (var n = 0; n < runs; n++) {
        describe('test ' + (n + 1), test("//*", 52));
      }
    });
  });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3QvZTJlL3VpY2F0YWxvZy9maW5kLWJ5LXhwYXRoLXNwZWNzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozt5QkFBa0IsZUFBZTs7Ozt1QkFDYixXQUFXOzs7O3dCQUNqQixVQUFVOzs7O3NCQUNWLFFBQVE7Ozs7Z0NBQ2MsdUJBQXVCOztBQUUzRCxRQUFRLENBQUMsMkJBQTJCLEVBQUUsWUFBWTtBQUNoRCxNQUFJLE9BQU8sR0FBRyw0QkFBTSxJQUFJLHVCQUFVLENBQUM7QUFDbkMsTUFBSSxNQUFNLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQzs7QUFFNUIsVUFBUSxDQUFDLGtCQUFrQixFQUFFLFlBQVk7OztBQUN2QyxjQUFVLENBQUM7VUFDTCxFQUFFOzs7Ozs2Q0FBUyxNQUFNLENBQUMsV0FBVyxDQUFDLE9BQU8sRUFBRSw2Q0FBNkMsQ0FBQzs7O0FBQXJGLGNBQUU7OzZDQUNBLE1BQU0sQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDOzs7Ozs7O0tBQ3ZCLENBQUMsQ0FBQzs7QUFFSCxhQUFTLENBQUM7VUFDSixFQUFFOzs7Ozs2Q0FBUyxNQUFNLENBQUMsV0FBVyxDQUFDLGtCQUFrQixFQUFFLFdBQVcsQ0FBQzs7O0FBQTlELGNBQUU7OzZDQUNBLE1BQU0sQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDOzs7OzZDQUNoQixzQkFBRSxLQUFLLENBQUMsSUFBSSxDQUFDOzs7Ozs7O0tBQ3BCLENBQUMsQ0FBQzs7QUFFSCxNQUFFLENBQUMsK0JBQStCLEVBQUU7VUFDOUIsRUFBRTs7Ozs7NkNBQVMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxPQUFPLEVBQUUscUJBQXFCLENBQUM7OztBQUE3RCxjQUFFOzs2Q0FDQyxNQUFNLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQzs7OzZCQUFFLE1BQU0sQ0FBQyxLQUFLLENBQUMsUUFBUTs7Ozs7OztLQUNqRCxDQUFDLENBQUM7OztBQUVILE1BQUUsQ0FBQyxnQ0FBZ0MsRUFBRTtVQUMvQixFQUFFOzs7Ozs2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R0FDSixDQUFDLENBQUM7Q0FDSixDQUFDLENBQUMiLCJmaWxlIjoidGVzdC9lMmUvdWljYXRhbG9nL2ZpbmQtYnkteHBhdGgtc3BlY3MuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgc2V0dXAgZnJvbSBcIi4uL3NldHVwLWJhc2VcIjtcbmltcG9ydCBkZXNpcmVkIGZyb20gJy4vZGVzaXJlZCc7XG5pbXBvcnQgQiBmcm9tICdibHVlYmlyZCc7XG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IHsgdGhyb3dNYXRjaGFibGVFcnJvciB9IGZyb20gJy4uL2hlbHBlcnMvcmVjaXBlcy5qcyc7XG5cbmRlc2NyaWJlKCd1aWNhdGFsb2cgLSBmaW5kIGJ5IHhwYXRoJywgZnVuY3Rpb24gKCkge1xuICBsZXQgc2Vzc2lvbiA9IHNldHVwKHRoaXMsIGRlc2lyZWQpO1xuICBsZXQgZHJpdmVyID0gc2Vzc2lvbi5kcml2ZXI7XG5cbiAgZGVzY3JpYmUoJ2luZGl2aWR1YWwgY2FsbHMnLCBmdW5jdGlvbiAoKSB7XG4gICAgYmVmb3JlRWFjaChhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBsZXQgZWwgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ3hwYXRoJywgXCIvL1VJQVN0YXRpY1RleHRbY29udGFpbnMoQGxhYmVsLCdCdXR0b25zJyldXCIpO1xuICAgICAgYXdhaXQgZHJpdmVyLmNsaWNrKGVsKTtcbiAgICB9KTtcblxuICAgIGFmdGVyRWFjaChhc3luYyAoKSA9PiB7XG4gICAgICBsZXQgZWwgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ2FjY2Vzc2liaWxpdHkgaWQnLCAnVUlDYXRhbG9nJyk7XG4gICAgICBhd2FpdCBkcml2ZXIuY2xpY2soZWwpO1xuICAgICAgYXdhaXQgQi5kZWxheSgxMDAwKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIHRoZSBsYXN0IGJ1dHRvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCBlbCA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgneHBhdGgnLCBcIi8vVUlBQnV0dG9uW2xhc3QoKV1cIik7XG4gICAgICAoYXdhaXQgZHJpdmVyLmdldFRleHQoZWwpKS5zaG91bGQuZXF1YWwoXCJCdXR0b25cIik7IC8vIHRoaXMgaXMgdGhlIG5hbWUgb2YgdGhlIGxhc3QgYnV0dG9uXG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBhIHNpbmdsZSBlbGVtZW50JywgYXN5bmMgKCkgPT4ge1xuICAgICAgbGV0IGVsID0gYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50KCd4cGF0aCcsIFwiLy9VSUFCdXR0b25cIik7XG4gICAgICAoYXdhaXQgZHJpdmVyLmdldFRleHQoZWwpKS5zaG91bGQuZXF1YWwoXCJVSUNhdGFsb2dcIik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBtdWx0aXBsZSBlbGVtZW50cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCBlbHMgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnRzKCd4cGF0aCcsIFwiLy9VSUFCdXR0b25cIik7XG4gICAgICBlbHMuc2hvdWxkLmhhdmUubGVuZ3RoLmFib3ZlKDUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBmaWx0ZXIgYnkgbmFtZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCBlbCA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgneHBhdGgnLCBcIi8vVUlBQnV0dG9uW0BuYW1lPSdYIEJ1dHRvbiddXCIpO1xuICAgICAgKGF3YWl0IGRyaXZlci5nZXRUZXh0KGVsKSkuc2hvdWxkLmVxdWFsKFwiWCBCdXR0b25cIik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGtub3cgaG93IHRvIHJlc3RyaWN0IHJvb3QtbGV2ZWwgZWxlbWVudHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCBCLnJlc29sdmUoZHJpdmVyLmZpbmRFbGVtZW50KCd4cGF0aCcsIFwiL1VJQUJ1dHRvblwiKSlcbiAgICAgICAgLmNhdGNoKHRocm93TWF0Y2hhYmxlRXJyb3IpXG4gICAgICAgIC5zaG91bGQuYmUucmVqZWN0ZWRXaXRoKC9qc29ud3BDb2RlOiA3Lyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHNlYXJjaCBhbiBleHRlbmRlZCBwYXRoIGJ5IGNoaWxkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbGV0IGVsID0gYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50KCd4cGF0aCcsIFwiLy9VSUFOYXZpZ2F0aW9uQmFyL1VJQVN0YXRpY1RleHRcIik7XG4gICAgICAoYXdhaXQgZHJpdmVyLmdldFRleHQoZWwpKS5zaG91bGQuZXF1YWwoJ0J1dHRvbnMnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc2VhcmNoIGFuIGV4dGVuZGVkIHBhdGggYnkgZGVzY2VuZGFudCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCBlbHMgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnRzKCd4cGF0aCcsIFwiLy9VSUFUYWJsZUNlbGwvL1VJQUJ1dHRvblwiKTtcbiAgICAgIGxldCB0ZXh0cyA9IGF3YWl0IEIuYWxsKF8ubWFwKGVscywgKGVsKSA9PiB7IHJldHVybiBkcml2ZXIuZ2V0VGV4dChlbCk7IH0pKTtcbiAgICAgIHRleHRzLnNob3VsZC5ub3QuaW5jbHVkZShcIlVJQ2F0YWxvZ1wiKTtcbiAgICAgIHRleHRzLnNob3VsZC5pbmNsdWRlKFwiWCBCdXR0b25cIik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGZpbHRlciBieSBpbmRpY2VzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgZHJpdmVyLmltcGxpY2l0V2FpdCgxMDAwMCk7XG4gICAgICBsZXQgZWwgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ3hwYXRoJywgXCIvL1VJQVRhYmxlQ2VsbFs0XS9VSUFCdXR0b25bMV1cIik7XG4gICAgICAoYXdhaXQgZHJpdmVyLmdldEF0dHJpYnV0ZSgnbmFtZScsIGVsKSkuc2hvdWxkLmVxdWFsKCdYIEJ1dHRvbicpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBmaWx0ZXIgYnkgcGFydGlhbCB0ZXh0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgbGV0IGVsID0gYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50KCd4cGF0aCcsIFwiLy9VSUFUYWJsZUNlbGwvL1VJQUJ1dHRvbltjb250YWlucyhAbmFtZSwgJ1ggJyldXCIpO1xuICAgICAgKGF3YWl0IGRyaXZlci5nZXRUZXh0KGVsKSkuc2hvdWxkLmVxdWFsKFwiWCBCdXR0b25cIik7XG4gICAgfSk7XG5cbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2R1cGxpY2F0ZSB0ZXh0IGZpZWxkJywgZnVuY3Rpb24gKCkge1xuXG4gICAgYmVmb3JlRWFjaChhc3luYyAoKSA9PiB7XG4gICAgICBsZXQgZWwgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ2FjY2Vzc2liaWxpdHkgaWQnLCAnVGV4dCBGaWVsZHMnKTtcbiAgICAgIGF3YWl0IGRyaXZlci5jbGljayhlbCk7XG4gICAgICBhd2FpdCBCLmRlbGF5KDIwMDApO1xuICAgIH0pO1xuXG4gICAgYWZ0ZXJFYWNoKGFzeW5jICgpID0+IHtcbiAgICAgIGxldCBlbCA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgnYWNjZXNzaWJpbGl0eSBpZCcsICdVSUNhdGFsb2cnKTtcbiAgICAgIGF3YWl0IGRyaXZlci5jbGljayhlbCk7XG4gICAgICBhd2FpdCBCLmRlbGF5KDEwMDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBmaW5kIG9ubHkgb25lIHRleHQgZmllbGQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBsZXQgZWxzID0gYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50cygneHBhdGgnLCAnLy9VSUFUYWJsZVZpZXdbXCJFbXB0eSBsaXN0XCJdL1VJQVRhYmxlQ2VsbFsxXS9VSUFUZXh0RmllbGQnKTtcbiAgICAgIGVscy5zaG91bGQuaGF2ZS5sZW5ndGgoMSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGZpbmQgb25seSBvbmUgdGV4dCBmaWVsZCB3aGVuIGRvaW5nIHJlbGF0aXZlIHNlYXJjaCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCBlbDIgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ3hwYXRoJywgJy8vVUlBVGFibGVWaWV3W1wiRW1wdHkgbGlzdFwiXScpO1xuICAgICAgbGV0IGVscyA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudHNGcm9tRWxlbWVudCgneHBhdGgnLCAnLy9VSUFUYWJsZUNlbGxbMV0vVUlBVGV4dEZpZWxkJywgZWwyKTtcbiAgICAgIGVscy5zaG91bGQuaGF2ZS5sZW5ndGgoMSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGZpbmQgb25seSBvbmUgc2VjdXJlIHRleHQgZmllbGQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBsZXQgZWxzID0gYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50cygneHBhdGgnLCAnLy9VSUFUYWJsZVZpZXdbXCJFbXB0eSBsaXN0XCJdL1VJQVRhYmxlQ2VsbFszXS9VSUFTZWN1cmVUZXh0RmllbGQnKTtcbiAgICAgIGVscy5zaG91bGQuaGF2ZS5sZW5ndGgoMSk7XG4gICAgfSk7XG5cbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ211bHRpcGxlIGNhbGxzJywgZnVuY3Rpb24gKCkge1xuICAgIGxldCBydW5zID0gNTtcblxuICAgIGxldCB0ZXN0ID0gZnVuY3Rpb24gKHBhdGgsIG1pbkxlbmd0aCkge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaXQoJ3Nob3VsZCBub3QgY3Jhc2gnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgbGV0IGVscyA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudHMoJ3hwYXRoJywgcGF0aCk7XG4gICAgICAgICAgZWxzLnNob3VsZC5oYXZlLmxlbmd0aC5hYm92ZShtaW5MZW5ndGgpO1xuICAgICAgICB9KTtcbiAgICAgIH07XG4gICAgfTtcblxuICAgIGRlc2NyaWJlKCdmaW5kaW5nIHNwZWNpZmljIHBhdGgnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBmb3IgKGxldCBuID0gMDsgbiA8IHJ1bnM7IG4rKykge1xuICAgICAgICBkZXNjcmliZShgdGVzdCAke24gKyAxfWAsIHRlc3QoXCIvL1VJQUFwcGxpY2F0aW9uWzFdL1VJQVdpbmRvdy9VSUFUYWJsZVZpZXcvVUlBVGFibGVDZWxsXCIsIDE3KSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnZmluZGluZyAvLyonLCBmdW5jdGlvbiAoKSB7XG4gICAgICBmb3IgKGxldCBuID0gMDsgbiA8IHJ1bnM7IG4rKykge1xuICAgICAgICBkZXNjcmliZShgdGVzdCAke24gKyAxfWAsIHRlc3QoXCIvLypcIiwgNTIpKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdfQ==