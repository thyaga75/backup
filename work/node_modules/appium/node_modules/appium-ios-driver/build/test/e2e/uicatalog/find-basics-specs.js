'use strict';

var _regeneratorRuntime = require('babel-runtime/regenerator')['default'];

var _getIterator = require('babel-runtime/core-js/get-iterator')['default'];

var _interopRequireDefault = require('babel-runtime/helpers/interop-require-default')['default'];

var _helpersEnv = require('../helpers/env');

var _helpersEnv2 = _interopRequireDefault(_helpersEnv);

var _setupBase = require("../setup-base");

var _setupBase2 = _interopRequireDefault(_setupBase);

var _desired = require('./desired');

var _desired2 = _interopRequireDefault(_desired);

var _bluebird = require('bluebird');

var _bluebird2 = _interopRequireDefault(_bluebird);

var _helpersRecipes = require('../helpers/recipes');

describe('uicatalog - find - basics', function () {
  var _this = this;

  var session = (0, _setupBase2['default'])(this, _desired2['default']);
  var driver = session.driver;

  it('should find a single element by id', function callee$1$0() {
    var el;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.findElement('id', 'Date Picker'));

        case 2:
          el = context$2$0.sent;

          el.should.exist;

        case 4:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });

  it('should find a single element by id wrapped in array for multi', function callee$1$0() {
    var els;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.findElements('id', 'Back'));

        case 2:
          els = context$2$0.sent;

          els.should.have.length(1);

        case 4:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });

  it('should find a single element using elementByAccessibilityId', function callee$1$0() {
    var axId, el;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          axId = _helpersEnv2['default'].IOS8 || _helpersEnv2['default'].IOS9 ? 'AAPLImageViewController' : 'Image View, AAPLImageViewController';
          context$2$0.next = 3;
          return _regeneratorRuntime.awrap(driver.findElement('accessibility id', axId));

        case 3:
          el = context$2$0.sent;

          el.should.exist;

        case 5:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });

  it('should find an element within descendants', function callee$1$0() {
    var el1, el2;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.findElement('xpath', "//UIATableCell[contains(@name, 'Buttons')]"));

        case 2:
          el1 = context$2$0.sent;

          el1.should.exist;
          context$2$0.next = 6;
          return _regeneratorRuntime.awrap(driver.findElementFromElement('class name', 'UIAStaticText', el1));

        case 6:
          el2 = context$2$0.sent;
          context$2$0.next = 9;
          return _regeneratorRuntime.awrap(driver.getAttribute('name', el2));

        case 9:
          context$2$0.sent.should.contain("Buttons");

        case 10:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });

  it('should not find an element not within itself', function callee$1$0() {
    var el1;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.findElement('xpath', "//UIATableCell[contains(@name, 'Buttons')]"));

        case 2:
          el1 = context$2$0.sent;

          el1.should.exist;
          context$2$0.next = 6;
          return _regeneratorRuntime.awrap(_bluebird2['default'].resolve(driver.findElementFromElement('class name', 'UIANavigationBar', el1))['catch'](_helpersRecipes.throwMatchableError).should.be.rejectedWith(/jsonwpCode: 7/));

        case 6:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });

  it('should find some elements within itself', function callee$1$0() {
    var elLength, el1, els;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          elLength = _helpersEnv2['default'].IOS8 || _helpersEnv2['default'].IOS9 ? 2 : 1;
          context$2$0.next = 3;
          return _regeneratorRuntime.awrap(driver.findElement('xpath', "//UIATableCell[contains(@name, 'Buttons')]"));

        case 3:
          el1 = context$2$0.sent;

          el1.should.exist;
          context$2$0.next = 7;
          return _regeneratorRuntime.awrap(driver.findElementsFromElement('class name', 'UIAStaticText', el1));

        case 7:
          els = context$2$0.sent;

          els.should.have.length(elLength);

        case 9:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });

  it('should not find elements not within itself', function callee$1$0() {
    var el1, els;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.findElement('xpath', "//UIATableCell[contains(@name, 'Buttons')]"));

        case 2:
          el1 = context$2$0.sent;

          el1.should.exist;
          context$2$0.next = 6;
          return _regeneratorRuntime.awrap(driver.findElementsFromElement('class name', 'UIANavigationBar', el1));

        case 6:
          els = context$2$0.sent;

          els.should.have.length(0);

        case 8:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });

  describe('no mix up', function () {
    after(function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            if (!(!_helpersEnv2['default'].IOS81 && !_helpersEnv2['default'].IOS82 && !_helpersEnv2['default'].IOS83 && !_helpersEnv2['default'].IOS84 && !_helpersEnv2['default'].IOS9)) {
              context$3$0.next = 3;
              break;
            }

            context$3$0.next = 3;
            return _regeneratorRuntime.awrap((0, _helpersRecipes.clickButton)(driver, 'UICatalog'));

          case 3:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });

    it('should not allow found elements to be mixed up', function callee$2$0() {
      var el1, el1Name, el2, el2Name;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('class name', 'UIATableCell'));

          case 2:
            el1 = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.getAttribute('name', el1));

          case 5:
            el1Name = context$3$0.sent;
            context$3$0.next = 8;
            return _regeneratorRuntime.awrap(driver.click(el1));

          case 8:
            context$3$0.next = 10;
            return _regeneratorRuntime.awrap(_bluebird2['default'].delay(1000));

          case 10:
            context$3$0.next = 12;
            return _regeneratorRuntime.awrap(driver.findElement('class name', 'UIATableCell'));

          case 12:
            el2 = context$3$0.sent;
            context$3$0.next = 15;
            return _regeneratorRuntime.awrap(driver.getAttribute('name', el2));

          case 15:
            el2Name = context$3$0.sent;

            el1.ELEMENT.should.not.equal(el2.ELEMENT);
            el1Name.should.not.equal(el2Name);

            // el1 is gone, so it doesn't have a name anymore
            context$3$0.next = 20;
            return _regeneratorRuntime.awrap(driver.getAttribute('name', el1));

          case 20:
            context$3$0.sent.should.equal("");

          case 21:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });
  });

  it('should return all image elements with internally generated ids', function callee$1$0() {
    var els, _iteratorNormalCompletion, _didIteratorError, _iteratorError, _iterator, _step, el;

    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.findElements('class name', 'UIAImage'));

        case 2:
          els = context$2$0.sent;

          els.length.should.be.above(0);
          _iteratorNormalCompletion = true;
          _didIteratorError = false;
          _iteratorError = undefined;
          context$2$0.prev = 7;
          for (_iterator = _getIterator(els); !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
            el = _step.value;

            el.should.exist;
          }
          context$2$0.next = 15;
          break;

        case 11:
          context$2$0.prev = 11;
          context$2$0.t0 = context$2$0['catch'](7);
          _didIteratorError = true;
          _iteratorError = context$2$0.t0;

        case 15:
          context$2$0.prev = 15;
          context$2$0.prev = 16;

          if (!_iteratorNormalCompletion && _iterator['return']) {
            _iterator['return']();
          }

        case 18:
          context$2$0.prev = 18;

          if (!_didIteratorError) {
            context$2$0.next = 21;
            break;
          }

          throw _iteratorError;

        case 21:
          return context$2$0.finish(18);

        case 22:
          return context$2$0.finish(15);

        case 23:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this, [[7, 11, 15, 23], [16,, 18, 22]]);
  });

  describe('findElementsByClassName textfield case', function () {
    after(function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            if (!(!_helpersEnv2['default'].IOS81 && !_helpersEnv2['default'].IOS82 && !_helpersEnv2['default'].IOS83 && !_helpersEnv2['default'].IOS84 && !_helpersEnv2['default'].IOS9)) {
              context$3$0.next = 3;
              break;
            }

            context$3$0.next = 3;
            return _regeneratorRuntime.awrap((0, _helpersRecipes.clickButton)(driver, 'UICatalog'));

          case 3:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });
    var axIdExt = _helpersEnv2['default'].IOS8 || _helpersEnv2['default'].IOS9 ? '' : ', AAPLActionSheetViewController';
    it('should find only one textfield', function callee$2$0() {
      var el1, el2, els;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('accessibility id', 'Action Sheets' + axIdExt));

          case 2:
            el1 = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.click(el1));

          case 5:
            context$3$0.next = 7;
            return _regeneratorRuntime.awrap(driver.findElement('accessibility id', 'Okay / Cancel'));

          case 7:
            el2 = context$3$0.sent;
            context$3$0.next = 10;
            return _regeneratorRuntime.awrap(driver.findElementsFromElement('class name', 'UIAStaticText', el2));

          case 10:
            els = context$3$0.sent;

            els.should.have.length(1);

          case 12:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });
  });

  describe('findElement(s) containing accessibility id', function () {
    afterEach(function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap((0, _helpersRecipes.clickButton)(driver, 'UICatalog'));

          case 2:
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(_bluebird2['default'].delay(1000));

          case 4:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });

    var axIdExt = _helpersEnv2['default'].IOS8 || _helpersEnv2['default'].IOS9 ? '' : ', AAPLActionSheetViewController';
    it('should find one element', function callee$2$0() {
      var el1, el2;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('accessibility id', 'Action Sheets' + axIdExt));

          case 2:
            el1 = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.click(el1));

          case 5:
            context$3$0.next = 7;
            return _regeneratorRuntime.awrap(driver.findElement('accessibility id', 'Okay / Cancel'));

          case 7:
            el2 = context$3$0.sent;
            context$3$0.next = 10;
            return _regeneratorRuntime.awrap(driver.getAttribute('name', el2));

          case 10:
            context$3$0.sent.should.equal('Okay / Cancel');

          case 11:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });

    it('should find several elements', function callee$2$0() {
      var el1, el2;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('accessibility id', 'Action Sheets' + axIdExt));

          case 2:
            el1 = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.click(el1));

          case 5:
            context$3$0.next = 7;
            return _regeneratorRuntime.awrap(driver.findElements('accessibility id', 'Okay / Cancel'));

          case 7:
            el2 = context$3$0.sent;

            el2.should.have.length(2);

          case 9:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });
  });

  describe('duplicate text field', function () {
    beforeEach(function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.prev = 0;
            context$3$0.next = 3;
            return _regeneratorRuntime.awrap(driver.execute("mobile: scroll", { direction: 'down' }));

          case 3:
            context$3$0.next = 7;
            break;

          case 5:
            context$3$0.prev = 5;
            context$3$0.t0 = context$3$0['catch'](0);

          case 7:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this, [[0, 5]]);
    });

    afterEach(function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap((0, _helpersRecipes.clickButton)(driver, 'UICatalog'));

          case 2:
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(_bluebird2['default'].delay(1000));

          case 4:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });

    var axIdExt = _helpersEnv2['default'].IOS8 || _helpersEnv2['default'].IOS9 ? '' : ', AAPLTextFieldViewController';

    it('should find only one element per text field', function callee$2$0() {
      var el1, els;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('accessibility id', 'Text Fields' + axIdExt));

          case 2:
            el1 = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.click(el1));

          case 5:
            _bluebird2['default'].delay(2000);
            context$3$0.next = 8;
            return _regeneratorRuntime.awrap(driver.findElements('class name', 'UIATextField'));

          case 8:
            els = context$3$0.sent;

            els.should.have.length(4);

          case 10:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });

    it('should find only one element per secure text field', function callee$2$0() {
      var el1, els;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('accessibility id', 'Text Fields' + axIdExt));

          case 2:
            el1 = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.click(el1));

          case 5:
            _bluebird2['default'].delay(2000);
            context$3$0.next = 8;
            return _regeneratorRuntime.awrap(driver.findElements('class name', 'UIASecureTextField'));

          case 8:
            els = context$3$0.sent;

            els.should.have.length(1);

          case 10:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });
  });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3QvZTJlL3VpY2F0YWxvZy9maW5kLWJhc2ljcy1zcGVjcy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7OzswQkFBZ0IsZ0JBQWdCOzs7O3lCQUNkLGVBQWU7Ozs7dUJBQ2IsV0FBVzs7Ozt3QkFDakIsVUFBVTs7Ozs4QkFDeUIsb0JBQW9COztBQUVyRSxRQUFRLENBQUMsMkJBQTJCLEVBQUUsWUFBWTs7O0FBQ2hELE1BQUksT0FBTyxHQUFHLDRCQUFNLElBQUksdUJBQVUsQ0FBQztBQUNuQyxNQUFJLE1BQU0sR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDOztBQUU1QixJQUFFLENBQUMsb0NBQW9DLEVBQUU7UUFDbkMsRUFBRTs7Ozs7MkNBQVMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxJQUFJLEVBQUUsYUFBYSxDQUFDOzs7QUFBbEQsWUFBRTs7QUFDTixZQUFFLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQzs7Ozs7OztHQUNqQixDQUFDLENBQUM7O0FBRUgsSUFBRSxDQUFDLCtEQUErRCxFQUFFO1FBQzlELEdBQUc7Ozs7OzJDQUFTLE1BQU0sQ0FBQyxZQUFZLENBQUMsSUFBSSxFQUFFLE1BQU0sQ0FBQzs7O0FBQTdDLGFBQUc7O0FBQ1AsYUFBRyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDOzs7Ozs7O0dBQzNCLENBQUMsQ0FBQzs7QUFFSCxJQUFFLENBQUMsNkRBQTZELEVBQUU7UUFDNUQsSUFBSSxFQUVKLEVBQUU7Ozs7QUFGRixjQUFJLEdBQUcsQUFBQyx3QkFBSSxJQUFJLElBQUksd0JBQUksSUFBSSxHQUFJLHlCQUF5QixHQUN6QixxQ0FBcUM7OzJDQUMxRCxNQUFNLENBQUMsV0FBVyxDQUFDLGtCQUFrQixFQUFFLElBQUksQ0FBQzs7O0FBQXZELFlBQUU7O0FBQ04sWUFBRSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUM7Ozs7Ozs7R0FDakIsQ0FBQyxDQUFDOztBQUVILElBQUUsQ0FBQywy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LGVBQUc7OzZDQUNELE1BQU0sQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDOzs7QUFDdkIsa0NBQUUsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDOzs2Q0FDRSxNQUFNLENBQUMsWUFBWSxDQUFDLFlBQVksRUFBRSxjQUFjLENBQUM7OztBQUE3RCxlQUFHOztBQUNQLGVBQUcsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQzs7Ozs7OztLQUMzQixDQUFDLENBQUM7O0FBRUgsTUFBRSxDQUFDLG9EQUFvRCxFQUFFO1VBQ25ELEdBQUcsRUFHSCxHQUFHOzs7Ozs2Q0FIUyxNQUFNLENBQUMsV0FBVyxDQUFDLGtCQUFrQixrQkFBZ0IsT0FBTyxDQUFHOzs7QUFBM0UsZUFBRzs7NkNBQ0QsTUFBTSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUM7OztBQUN2QixrQ0FBRSxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7OzZDQUNFLE1BQU0sQ0FBQyxZQUFZLENBQUMsWUFBWSxFQUFFLG9CQUFvQixDQUFDOzs7QUFBbkUsZUFBRzs7QUFDUCxlQUFHLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUM7Ozs7Ozs7S0FDM0IsQ0FBQyxDQUFDO0dBRUosQ0FBQyxDQUFDO0NBRUosQ0FBQyxDQUFDIiwiZmlsZSI6InRlc3QvZTJlL3VpY2F0YWxvZy9maW5kLWJhc2ljcy1zcGVjcy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBlbnYgZnJvbSAnLi4vaGVscGVycy9lbnYnO1xuaW1wb3J0IHNldHVwIGZyb20gXCIuLi9zZXR1cC1iYXNlXCI7XG5pbXBvcnQgZGVzaXJlZCBmcm9tICcuL2Rlc2lyZWQnO1xuaW1wb3J0IEIgZnJvbSAnYmx1ZWJpcmQnO1xuaW1wb3J0IHsgY2xpY2tCdXR0b24sIHRocm93TWF0Y2hhYmxlRXJyb3IgfSBmcm9tICcuLi9oZWxwZXJzL3JlY2lwZXMnO1xuXG5kZXNjcmliZSgndWljYXRhbG9nIC0gZmluZCAtIGJhc2ljcycsIGZ1bmN0aW9uICgpIHtcbiAgbGV0IHNlc3Npb24gPSBzZXR1cCh0aGlzLCBkZXNpcmVkKTtcbiAgbGV0IGRyaXZlciA9IHNlc3Npb24uZHJpdmVyO1xuXG4gIGl0KCdzaG91bGQgZmluZCBhIHNpbmdsZSBlbGVtZW50IGJ5IGlkJywgYXN5bmMgKCkgPT4ge1xuICAgIGxldCBlbCA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgnaWQnLCAnRGF0ZSBQaWNrZXInKTtcbiAgICBlbC5zaG91bGQuZXhpc3Q7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgZmluZCBhIHNpbmdsZSBlbGVtZW50IGJ5IGlkIHdyYXBwZWQgaW4gYXJyYXkgZm9yIG11bHRpJywgYXN5bmMgKCkgPT4ge1xuICAgIGxldCBlbHMgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnRzKCdpZCcsICdCYWNrJyk7XG4gICAgZWxzLnNob3VsZC5oYXZlLmxlbmd0aCgxKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBmaW5kIGEgc2luZ2xlIGVsZW1lbnQgdXNpbmcgZWxlbWVudEJ5QWNjZXNzaWJpbGl0eUlkJywgYXN5bmMgKCkgPT4ge1xuICAgIGxldCBheElkID0gKGVudi5JT1M4IHx8IGVudi5JT1M5KSA/ICdBQVBMSW1hZ2VWaWV3Q29udHJvbGxlcicgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdJbWFnZSBWaWV3LCBBQVBMSW1hZ2VWaWV3Q29udHJvbGxlcic7XG4gICAgbGV0IGVsID0gYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50KCdhY2Nlc3NpYmlsaXR5IGlkJywgYXhJZCk7XG4gICAgZWwuc2hvdWxkLmV4aXN0O1xuICB9KTtcblxuICBpdCgnc2hvdWxkIGZpbmQgYW4gZWxlbWVudCB3aXRoaW4gZGVzY2VuZGFudHMnLCBhc3luYyAoKSA9PiB7XG4gICAgbGV0IGVsMSA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgneHBhdGgnLCBcIi8vVUlBVGFibGVDZWxsW2NvbnRhaW5zKEBuYW1lLCAnQnV0dG9ucycpXVwiKTtcbiAgICBlbDEuc2hvdWxkLmV4aXN0O1xuICAgIGxldCBlbDIgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnRGcm9tRWxlbWVudCgnY2xhc3MgbmFtZScsICdVSUFTdGF0aWNUZXh0JywgZWwxKTtcbiAgICAoYXdhaXQgZHJpdmVyLmdldEF0dHJpYnV0ZSgnbmFtZScsIGVsMikpLnNob3VsZC5jb250YWluKFwiQnV0dG9uc1wiKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBub3QgZmluZCBhbiBlbGVtZW50IG5vdCB3aXRoaW4gaXRzZWxmJywgYXN5bmMgKCkgPT4ge1xuICAgIGxldCBlbDEgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ3hwYXRoJywgXCIvL1VJQVRhYmxlQ2VsbFtjb250YWlucyhAbmFtZSwgJ0J1dHRvbnMnKV1cIik7XG4gICAgZWwxLnNob3VsZC5leGlzdDtcbiAgICBhd2FpdCBCLnJlc29sdmUoZHJpdmVyLmZpbmRFbGVtZW50RnJvbUVsZW1lbnQoJ2NsYXNzIG5hbWUnLCAnVUlBTmF2aWdhdGlvbkJhcicsIGVsMSkpXG4gICAgICAuY2F0Y2godGhyb3dNYXRjaGFibGVFcnJvcilcbiAgICAgIC5zaG91bGQuYmUucmVqZWN0ZWRXaXRoKC9qc29ud3BDb2RlOiA3Lyk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgZmluZCBzb21lIGVsZW1lbnRzIHdpdGhpbiBpdHNlbGYnLCBhc3luYyAoKSA9PiB7XG4gICAgbGV0IGVsTGVuZ3RoID0gKGVudi5JT1M4IHx8IGVudi5JT1M5KSA/IDIgOiAxO1xuICAgIGxldCBlbDEgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ3hwYXRoJywgXCIvL1VJQVRhYmxlQ2VsbFtjb250YWlucyhAbmFtZSwgJ0J1dHRvbnMnKV1cIik7XG4gICAgZWwxLnNob3VsZC5leGlzdDtcbiAgICBsZXQgZWxzID0gYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50c0Zyb21FbGVtZW50KCdjbGFzcyBuYW1lJywgJ1VJQVN0YXRpY1RleHQnLCBlbDEpO1xuICAgIGVscy5zaG91bGQuaGF2ZS5sZW5ndGgoZWxMZW5ndGgpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIG5vdCBmaW5kIGVsZW1lbnRzIG5vdCB3aXRoaW4gaXRzZWxmJywgYXN5bmMgKCkgPT4ge1xuICAgIGxldCBlbDEgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ3hwYXRoJywgXCIvL1VJQVRhYmxlQ2VsbFtjb250YWlucyhAbmFtZSwgJ0J1dHRvbnMnKV1cIik7XG4gICAgZWwxLnNob3VsZC5leGlzdDtcbiAgICBsZXQgZWxzID0gYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50c0Zyb21FbGVtZW50KCdjbGFzcyBuYW1lJywgJ1VJQU5hdmlnYXRpb25CYXInLCBlbDEpO1xuICAgIGVscy5zaG91bGQuaGF2ZS5sZW5ndGgoMCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdubyBtaXggdXAnLCAoKSA9PiB7XG4gICAgYWZ0ZXIoYXN5bmMoKSA9PiB7XG4gICAgICBpZiAoIWVudi5JT1M4MSAmJiAhZW52LklPUzgyICYmICFlbnYuSU9TODMgJiYgIWVudi5JT1M4NCAmJiAhZW52LklPUzkpIHtcbiAgICAgICAgYXdhaXQgY2xpY2tCdXR0b24oZHJpdmVyLCAnVUlDYXRhbG9nJyk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIG5vdCBhbGxvdyBmb3VuZCBlbGVtZW50cyB0byBiZSBtaXhlZCB1cCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCBlbDEgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ2NsYXNzIG5hbWUnLCAnVUlBVGFibGVDZWxsJyk7XG4gICAgICBsZXQgZWwxTmFtZSA9IGF3YWl0IGRyaXZlci5nZXRBdHRyaWJ1dGUoJ25hbWUnLCBlbDEpO1xuICAgICAgYXdhaXQgZHJpdmVyLmNsaWNrKGVsMSk7XG4gICAgICBhd2FpdCBCLmRlbGF5KDEwMDApO1xuXG4gICAgICBsZXQgZWwyID0gYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50KCdjbGFzcyBuYW1lJywgJ1VJQVRhYmxlQ2VsbCcpO1xuICAgICAgbGV0IGVsMk5hbWUgPSBhd2FpdCBkcml2ZXIuZ2V0QXR0cmlidXRlKCduYW1lJywgZWwyKTtcbiAgICAgIGVsMS5FTEVNRU5ULnNob3VsZC5ub3QuZXF1YWwoZWwyLkVMRU1FTlQpO1xuICAgICAgZWwxTmFtZS5zaG91bGQubm90LmVxdWFsKGVsMk5hbWUpO1xuXG4gICAgICAvLyBlbDEgaXMgZ29uZSwgc28gaXQgZG9lc24ndCBoYXZlIGEgbmFtZSBhbnltb3JlXG4gICAgICAoYXdhaXQgZHJpdmVyLmdldEF0dHJpYnV0ZSgnbmFtZScsIGVsMSkpLnNob3VsZC5lcXVhbChcIlwiKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCByZXR1cm4gYWxsIGltYWdlIGVsZW1lbnRzIHdpdGggaW50ZXJuYWxseSBnZW5lcmF0ZWQgaWRzJywgYXN5bmMgKCkgPT4ge1xuICAgIGxldCBlbHMgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnRzKCdjbGFzcyBuYW1lJywgJ1VJQUltYWdlJyk7XG4gICAgZWxzLmxlbmd0aC5zaG91bGQuYmUuYWJvdmUoMCk7XG4gICAgZm9yIChsZXQgZWwgb2YgZWxzKSB7XG4gICAgICBlbC5zaG91bGQuZXhpc3Q7XG4gICAgfVxuICB9KTtcblxuICBkZXNjcmliZSgnZmluZEVsZW1lbnRzQnlDbGFzc05hbWUgdGV4dGZpZWxkIGNhc2UnLCAoKSA9PiB7XG4gICAgYWZ0ZXIoYXN5bmMgKCkgPT4ge1xuICAgICAgaWYgKCFlbnYuSU9TODEgJiYgIWVudi5JT1M4MiAmJiAhZW52LklPUzgzICYmICFlbnYuSU9TODQgJiYgIWVudi5JT1M5KSB7XG4gICAgICAgIGF3YWl0IGNsaWNrQnV0dG9uKGRyaXZlciwgJ1VJQ2F0YWxvZycpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIGxldCBheElkRXh0ID0gKGVudi5JT1M4IHx8IGVudi5JT1M5KSA/ICcnIDogJywgQUFQTEFjdGlvblNoZWV0Vmlld0NvbnRyb2xsZXInO1xuICAgIGl0KCdzaG91bGQgZmluZCBvbmx5IG9uZSB0ZXh0ZmllbGQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBsZXQgZWwxID0gYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50KCdhY2Nlc3NpYmlsaXR5IGlkJywgYEFjdGlvbiBTaGVldHMke2F4SWRFeHR9YCk7XG4gICAgICBhd2FpdCBkcml2ZXIuY2xpY2soZWwxKTtcbiAgICAgIGxldCBlbDIgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ2FjY2Vzc2liaWxpdHkgaWQnLCAnT2theSAvIENhbmNlbCcpO1xuICAgICAgbGV0IGVscyA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudHNGcm9tRWxlbWVudCgnY2xhc3MgbmFtZScsICdVSUFTdGF0aWNUZXh0JywgZWwyKTtcbiAgICAgIGVscy5zaG91bGQuaGF2ZS5sZW5ndGgoMSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdmaW5kRWxlbWVudChzKSBjb250YWluaW5nIGFjY2Vzc2liaWxpdHkgaWQnLCAoKSA9PiB7XG4gICAgYWZ0ZXJFYWNoKGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IGNsaWNrQnV0dG9uKGRyaXZlciwgJ1VJQ2F0YWxvZycpO1xuICAgICAgYXdhaXQgQi5kZWxheSgxMDAwKTtcbiAgICB9KTtcblxuICAgIGxldCBheElkRXh0ID0gKGVudi5JT1M4IHx8IGVudi5JT1M5KSA/ICcnIDogJywgQUFQTEFjdGlvblNoZWV0Vmlld0NvbnRyb2xsZXInO1xuICAgIGl0KCdzaG91bGQgZmluZCBvbmUgZWxlbWVudCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCBlbDEgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ2FjY2Vzc2liaWxpdHkgaWQnLCBgQWN0aW9uIFNoZWV0cyR7YXhJZEV4dH1gKTtcbiAgICAgIGF3YWl0IGRyaXZlci5jbGljayhlbDEpO1xuICAgICAgbGV0IGVsMiA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgnYWNjZXNzaWJpbGl0eSBpZCcsICdPa2F5IC8gQ2FuY2VsJyk7XG4gICAgICAoYXdhaXQgZHJpdmVyLmdldEF0dHJpYnV0ZSgnbmFtZScsIGVsMikpLnNob3VsZC5lcXVhbCgnT2theSAvIENhbmNlbCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBmaW5kIHNldmVyYWwgZWxlbWVudHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBsZXQgZWwxID0gYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50KCdhY2Nlc3NpYmlsaXR5IGlkJywgYEFjdGlvbiBTaGVldHMke2F4SWRFeHR9YCk7XG4gICAgICBhd2FpdCBkcml2ZXIuY2xpY2soZWwxKTtcbiAgICAgIGxldCBlbDIgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnRzKCdhY2Nlc3NpYmlsaXR5IGlkJywgJ09rYXkgLyBDYW5jZWwnKTtcbiAgICAgIGVsMi5zaG91bGQuaGF2ZS5sZW5ndGgoMik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdkdXBsaWNhdGUgdGV4dCBmaWVsZCcsICgpID0+IHtcbiAgICBiZWZvcmVFYWNoKGFzeW5jICgpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IGRyaXZlci5leGVjdXRlKFwibW9iaWxlOiBzY3JvbGxcIiwge2RpcmVjdGlvbjogJ2Rvd24nfSk7XG4gICAgICB9IGNhdGNoIChpZ24pIHt9XG4gICAgfSk7XG5cbiAgICBhZnRlckVhY2goYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgY2xpY2tCdXR0b24oZHJpdmVyLCAnVUlDYXRhbG9nJyk7XG4gICAgICBhd2FpdCBCLmRlbGF5KDEwMDApO1xuICAgIH0pO1xuXG4gICAgbGV0IGF4SWRFeHQgPSAoZW52LklPUzggfHwgZW52LklPUzkpID8gJycgOiAnLCBBQVBMVGV4dEZpZWxkVmlld0NvbnRyb2xsZXInO1xuXG4gICAgaXQoJ3Nob3VsZCBmaW5kIG9ubHkgb25lIGVsZW1lbnQgcGVyIHRleHQgZmllbGQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBsZXQgZWwxID0gYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50KCdhY2Nlc3NpYmlsaXR5IGlkJywgYFRleHQgRmllbGRzJHtheElkRXh0fWApO1xuICAgICAgYXdhaXQgZHJpdmVyLmNsaWNrKGVsMSk7XG4gICAgICBCLmRlbGF5KDIwMDApO1xuICAgICAgbGV0IGVscyA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudHMoJ2NsYXNzIG5hbWUnLCAnVUlBVGV4dEZpZWxkJyk7XG4gICAgICBlbHMuc2hvdWxkLmhhdmUubGVuZ3RoKDQpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBmaW5kIG9ubHkgb25lIGVsZW1lbnQgcGVyIHNlY3VyZSB0ZXh0IGZpZWxkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbGV0IGVsMSA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgnYWNjZXNzaWJpbGl0eSBpZCcsIGBUZXh0IEZpZWxkcyR7YXhJZEV4dH1gKTtcbiAgICAgIGF3YWl0IGRyaXZlci5jbGljayhlbDEpO1xuICAgICAgQi5kZWxheSgyMDAwKTtcbiAgICAgIGxldCBlbHMgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnRzKCdjbGFzcyBuYW1lJywgJ1VJQVNlY3VyZVRleHRGaWVsZCcpO1xuICAgICAgZWxzLnNob3VsZC5oYXZlLmxlbmd0aCgxKTtcbiAgICB9KTtcblxuICB9KTtcblxufSk7XG4iXX0=