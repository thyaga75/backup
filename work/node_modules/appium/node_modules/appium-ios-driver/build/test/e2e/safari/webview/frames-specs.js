'use strict';

var _regeneratorRuntime = require('babel-runtime/regenerator')['default'];

var _interopRequireDefault = require('babel-runtime/helpers/interop-require-default')['default'];

var _desired = require('./desired');

var _desired2 = _interopRequireDefault(_desired);

var _setupBase = require('../../setup-base');

var _setupBase2 = _interopRequireDefault(_setupBase);

var _helpersWebview = require('../../helpers/webview');

var _helpersEnv = require('../../helpers/env');

var _helpersEnv2 = _interopRequireDefault(_helpersEnv);

var GET_ELEM_SYNC = 'return document.getElementsByTagName(\'h1\')[0].innerHTML;';
var GET_ELEM_ASYNC = 'arguments[arguments.length - 1](document.getElementsByTagName(\'h1\')[0].innerHTML);';

describe('safari - webview - frames', function () {
  var _this = this;

  var driver = (0, _setupBase2['default'])(this, _desired2['default'], { 'no-reset': true }, false, true).driver;

  beforeEach(function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap((0, _helpersWebview.loadWebView)(_desired2['default'], driver, _helpersEnv2['default'].TEST_END_POINT + 'frameset.html', 'Frameset guinea pig'));

        case 2:
          return context$2$0.abrupt('return', context$2$0.sent);

        case 3:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });

  it('should switch to frame by name', function callee$1$0() {
    var h1;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.setFrame('first'));

        case 2:
          context$2$0.next = 4;
          return _regeneratorRuntime.awrap(driver.title());

        case 4:
          context$2$0.sent.should.be.equal('Frameset guinea pig');
          context$2$0.next = 7;
          return _regeneratorRuntime.awrap(driver.findElement('tag name', 'h1'));

        case 7:
          h1 = context$2$0.sent;
          context$2$0.next = 10;
          return _regeneratorRuntime.awrap(driver.getText(h1));

        case 10:
          context$2$0.sent.should.be.equal('Sub frame 1');

        case 11:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });

  it('should switch to frame by index', function callee$1$0() {
    var h1;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.setFrame(1));

        case 2:
          context$2$0.next = 4;
          return _regeneratorRuntime.awrap(driver.title());

        case 4:
          context$2$0.sent.should.be.equal('Frameset guinea pig');
          context$2$0.next = 7;
          return _regeneratorRuntime.awrap(driver.findElement('tag name', 'h1'));

        case 7:
          h1 = context$2$0.sent;
          context$2$0.next = 10;
          return _regeneratorRuntime.awrap(driver.getText(h1));

        case 10:
          context$2$0.sent.should.be.equal('Sub frame 2');

        case 11:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });

  it('should switch to frame by id', function callee$1$0() {
    var h1;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.setFrame('frame3'));

        case 2:
          context$2$0.next = 4;
          return _regeneratorRuntime.awrap(driver.title());

        case 4:
          context$2$0.sent.should.be.equal('Frameset guinea pig');
          context$2$0.next = 7;
          return _regeneratorRuntime.awrap(driver.findElement('tag name', 'h1'));

        case 7:
          h1 = context$2$0.sent;
          context$2$0.next = 10;
          return _regeneratorRuntime.awrap(driver.getText(h1));

        case 10:
          context$2$0.sent.should.be.equal('Sub frame 3');

        case 11:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });

  it('should switch back to default content from frame', function callee$1$0() {
    var h1;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.setFrame('first'));

        case 2:
          context$2$0.next = 4;
          return _regeneratorRuntime.awrap(driver.title());

        case 4:
          context$2$0.sent.should.be.equal('Frameset guinea pig');
          context$2$0.next = 7;
          return _regeneratorRuntime.awrap(driver.findElement('tag name', 'h1'));

        case 7:
          h1 = context$2$0.sent;
          context$2$0.next = 10;
          return _regeneratorRuntime.awrap(driver.getText(h1));

        case 10:
          context$2$0.sent.should.be.equal('Sub frame 1');
          context$2$0.next = 13;
          return _regeneratorRuntime.awrap(driver.setFrame(null));

        case 13:
          context$2$0.next = 15;
          return _regeneratorRuntime.awrap(driver.findElement('tag name', 'frameset'));

        case 15:
          context$2$0.sent.should.exist;

        case 16:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });

  it('should switch to child frames', function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.setFrame('third'));

        case 2:
          context$2$0.next = 4;
          return _regeneratorRuntime.awrap(driver.title());

        case 4:
          context$2$0.sent.should.be.equal('Frameset guinea pig');
          context$2$0.next = 7;
          return _regeneratorRuntime.awrap(driver.setFrame('childframe'));

        case 7:
          context$2$0.next = 9;
          return _regeneratorRuntime.awrap(driver.findElement('id', 'only_on_page_2'));

        case 9:
          context$2$0.sent.should.exist;

        case 10:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });

  it('should execute javascript in frame', function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.setFrame('first'));

        case 2:
          context$2$0.next = 4;
          return _regeneratorRuntime.awrap(driver.execute(GET_ELEM_SYNC));

        case 4:
          context$2$0.sent.should.be.equal('Sub frame 1');

        case 5:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });

  it('should execute async javascript in frame', function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.setFrame('first'));

        case 2:
          context$2$0.next = 4;
          return _regeneratorRuntime.awrap(driver.executeAsync(GET_ELEM_ASYNC));

        case 4:
          context$2$0.sent.should.be.equal('Sub frame 1');

        case 5:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3QvZTJlL3NhZmFyaS93ZWJ2aWV3L2ZyYW1lcy1zcGVjcy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7dUJBQW9CLFdBQVc7Ozs7eUJBQ2Isa0JBQWtCOzs7OzhCQUNSLHVCQUF1Qjs7MEJBQ25DLG1CQUFtQjs7OztBQUduQyxJQUFNLGFBQWEsK0RBQTZELENBQUM7QUFDakYsSUFBTSxjQUFjLHlGQUF1RixDQUFDOztBQUU1RyxRQUFRLENBQUMsMkJBQTJCLEVBQUUsWUFBVzs7O0FBQy9DLE1BQU0sTUFBTSxHQUFHLDRCQUFNLElBQUksd0JBQVcsRUFBQyxVQUFVLEVBQUUsSUFBSSxFQUFDLEVBQUUsS0FBSyxFQUFFLElBQUksQ0FBQyxDQUFDLE1BQU0sQ0FBQzs7QUFFNUUsWUFBVSxDQUFDOzs7OzsyQ0FBa0IsdURBRTNCLE1BQU0sRUFDSCx3QkFBSSxjQUFjLG9CQUNyQixxQkFBcUIsQ0FDdEI7Ozs7Ozs7Ozs7R0FBQSxDQUFDLENBQUM7O0FBRUgsSUFBRSxDQUFDLGdDQUFnQyxFQUFFO1FBSS9CLEVBQUU7Ozs7OzJDQUhBLE1BQU0sQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDOzs7OzJDQUN2QixNQUFNLENBQUMsS0FBSyxFQUFFOzs7MkJBQUUsTUFBTSxDQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUMscUJBQXFCOzsyQ0FFN0MsTUFBTSxDQUFDLFdBQVcsQ0FBQyxVQUFVLEVBQUUsSUFBSSxDQUFDOzs7QUFBL0MsWUFBRTs7MkNBQ0MsTUFBTSxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUM7OzsyQkFBRSxNQUFNLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQyxhQUFhOzs7Ozs7O0dBQ3pELENBQUMsQ0FBQzs7QUFFSCxJQUFFLENBQUMsaUNBQWlDLEVBQUU7UUFJaEMsRUFBRTs7Ozs7MkNBSEEsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUM7Ozs7MkNBQ2pCLE1BQU0sQ0FBQyxLQUFLLEVBQUU7OzsyQkFBRSxNQUFNLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQyxxQkFBcUI7OzJDQUU3QyxNQUFNLENBQUMsV0FBVyxDQUFDLFVBQVUsRUFBRSxJQUFJLENBQUM7OztBQUEvQyxZQUFFOzsyQ0FDQyxNQUFNLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQzs7OzJCQUFFLE1BQU0sQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLGFBQWE7Ozs7Ozs7R0FDekQsQ0FBQyxDQUFDOztBQUVILElBQUUsQ0FBQyw4QkFBOEIsRUFBRTtRQUk3QixFQUFFOzs7OzsyQ0FIQSxNQUFNLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQzs7OzsyQ0FDeEIsTUFBTSxDQUFDLEtBQUssRUFBRTs7OzJCQUFFLE1BQU0sQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLHFCQUFxQjs7MkNBRTdDLE1BQU0sQ0FBQyxXQUFXLENBQUMsVUFBVSxFQUFFLElBQUksQ0FBQzs7O0FBQS9DLFlBQUU7OzJDQUNDLE1BQU0sQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDOzs7MkJBQUUsTUFBTSxDQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUMsYUFBYTs7Ozs7OztHQUN6RCxDQUFDLENBQUM7O0FBRUgsSUFBRSxDQUFDLGtEQUFrRCxFQUFFO1FBSWpELEVBQUU7Ozs7OzJDQUhBLE1BQU0sQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDOzs7OzJDQUN2QixNQUFNLENBQUMsS0FBSyxFQUFFOzs7MkJBQUUsTUFBTSxDQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUMscUJBQXFCOzsyQ0FFN0MsTUFBTSxDQUFDLFdBQVcsQ0FBQyxVQUFVLEVBQUUsSUFBSSxDQUFDOzs7QUFBL0MsWUFBRTs7MkNBQ0MsTUFBTSxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUM7OzsyQkFBRSxNQUFNLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQyxhQUFhOzsyQ0FFbEQsTUFBTSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUM7Ozs7MkNBQ3BCLE1BQU0sQ0FBQyxXQUFXLENBQUMsVUFBVSxFQUFFLFVBQVUsQ0FBQzs7OzJCQUFFLE1BQU0sQ0FBQyxLQUFLOzs7Ozs7O0dBQ2hFLENBQUMsQ0FBQzs7QUFFSCxJQUFFLENBQUMsK0JBQStCLEVBQUU7Ozs7OzJDQUM1QixNQUFNLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQzs7OzsyQ0FDdkIsTUFBTSxDQUFDLEtBQUssRUFBRTs7OzJCQUFFLE1BQU0sQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLHFCQUFxQjs7MkNBRXRELE1BQU0sQ0FBQyxRQUFRLENBQUMsWUFBWSxDQUFDOzs7OzJDQUM1QixNQUFNLENBQUMsV0FBVyxDQUFDLElBQUksRUFBRSxnQkFBZ0IsQ0FBQzs7OzJCQUFFLE1BQU0sQ0FBQyxLQUFLOzs7Ozs7O0dBQ2hFLENBQUMsQ0FBQzs7QUFFSCxJQUFFLENBQUMsb0NBQW9DLEVBQUU7Ozs7OzJDQUNqQyxNQUFNLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQzs7OzsyQ0FDdkIsTUFBTSxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUM7OzsyQkFBRSxNQUFNLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQyxhQUFhOzs7Ozs7O0dBQ3BFLENBQUMsQ0FBQzs7QUFFSCxJQUFFLENBQUMsMENBQTBDLEVBQUU7Ozs7OzJDQUN2QyxNQUFNLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQzs7OzsyQ0FDdkIsTUFBTSxDQUFDLFlBQVksQ0FBQyxjQUFjLENBQUM7OzsyQkFBRSxNQUFNLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQyxhQUFhOzs7Ozs7O0dBQzFFLENBQUMsQ0FBQztDQUNKLENBQUMsQ0FBQyIsImZpbGUiOiJ0ZXN0L2UyZS9zYWZhcmkvd2Vidmlldy9mcmFtZXMtc3BlY3MuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZGVzaXJlZCBmcm9tICcuL2Rlc2lyZWQnO1xuaW1wb3J0IHNldHVwIGZyb20gJy4uLy4uL3NldHVwLWJhc2UnO1xuaW1wb3J0IHsgbG9hZFdlYlZpZXcgfSBmcm9tICcuLi8uLi9oZWxwZXJzL3dlYnZpZXcnO1xuaW1wb3J0IGVudiBmcm9tICcuLi8uLi9oZWxwZXJzL2Vudic7XG5cblxuY29uc3QgR0VUX0VMRU1fU1lOQyA9IGByZXR1cm4gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2gxJylbMF0uaW5uZXJIVE1MO2A7XG5jb25zdCBHRVRfRUxFTV9BU1lOQyA9IGBhcmd1bWVudHNbYXJndW1lbnRzLmxlbmd0aCAtIDFdKGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoMScpWzBdLmlubmVySFRNTCk7YDtcblxuZGVzY3JpYmUoJ3NhZmFyaSAtIHdlYnZpZXcgLSBmcmFtZXMnLCBmdW5jdGlvbigpIHtcbiAgY29uc3QgZHJpdmVyID0gc2V0dXAodGhpcywgZGVzaXJlZCwgeyduby1yZXNldCc6IHRydWV9LCBmYWxzZSwgdHJ1ZSkuZHJpdmVyO1xuXG4gIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4gYXdhaXQgbG9hZFdlYlZpZXcoXG4gICAgZGVzaXJlZCxcbiAgICBkcml2ZXIsXG4gICAgYCR7ZW52LlRFU1RfRU5EX1BPSU5UfWZyYW1lc2V0Lmh0bWxgLFxuICAgICdGcmFtZXNldCBndWluZWEgcGlnJ1xuICApKTtcblxuICBpdCgnc2hvdWxkIHN3aXRjaCB0byBmcmFtZSBieSBuYW1lJywgYXN5bmMgKCkgPT4ge1xuICAgIGF3YWl0IGRyaXZlci5zZXRGcmFtZSgnZmlyc3QnKTtcbiAgICAoYXdhaXQgZHJpdmVyLnRpdGxlKCkpLnNob3VsZC5iZS5lcXVhbCgnRnJhbWVzZXQgZ3VpbmVhIHBpZycpO1xuXG4gICAgbGV0IGgxID0gYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50KCd0YWcgbmFtZScsICdoMScpO1xuICAgIChhd2FpdCBkcml2ZXIuZ2V0VGV4dChoMSkpLnNob3VsZC5iZS5lcXVhbCgnU3ViIGZyYW1lIDEnKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBzd2l0Y2ggdG8gZnJhbWUgYnkgaW5kZXgnLCBhc3luYyAoKSA9PiB7XG4gICAgYXdhaXQgZHJpdmVyLnNldEZyYW1lKDEpO1xuICAgIChhd2FpdCBkcml2ZXIudGl0bGUoKSkuc2hvdWxkLmJlLmVxdWFsKCdGcmFtZXNldCBndWluZWEgcGlnJyk7XG5cbiAgICBsZXQgaDEgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ3RhZyBuYW1lJywgJ2gxJyk7XG4gICAgKGF3YWl0IGRyaXZlci5nZXRUZXh0KGgxKSkuc2hvdWxkLmJlLmVxdWFsKCdTdWIgZnJhbWUgMicpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIHN3aXRjaCB0byBmcmFtZSBieSBpZCcsIGFzeW5jICgpID0+IHtcbiAgICBhd2FpdCBkcml2ZXIuc2V0RnJhbWUoJ2ZyYW1lMycpO1xuICAgIChhd2FpdCBkcml2ZXIudGl0bGUoKSkuc2hvdWxkLmJlLmVxdWFsKCdGcmFtZXNldCBndWluZWEgcGlnJyk7XG5cbiAgICBsZXQgaDEgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ3RhZyBuYW1lJywgJ2gxJyk7XG4gICAgKGF3YWl0IGRyaXZlci5nZXRUZXh0KGgxKSkuc2hvdWxkLmJlLmVxdWFsKCdTdWIgZnJhbWUgMycpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIHN3aXRjaCBiYWNrIHRvIGRlZmF1bHQgY29udGVudCBmcm9tIGZyYW1lJywgYXN5bmMgKCkgPT4ge1xuICAgIGF3YWl0IGRyaXZlci5zZXRGcmFtZSgnZmlyc3QnKTtcbiAgICAoYXdhaXQgZHJpdmVyLnRpdGxlKCkpLnNob3VsZC5iZS5lcXVhbCgnRnJhbWVzZXQgZ3VpbmVhIHBpZycpO1xuXG4gICAgbGV0IGgxID0gYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50KCd0YWcgbmFtZScsICdoMScpO1xuICAgIChhd2FpdCBkcml2ZXIuZ2V0VGV4dChoMSkpLnNob3VsZC5iZS5lcXVhbCgnU3ViIGZyYW1lIDEnKTtcblxuICAgIGF3YWl0IGRyaXZlci5zZXRGcmFtZShudWxsKTtcbiAgICAoYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50KCd0YWcgbmFtZScsICdmcmFtZXNldCcpKS5zaG91bGQuZXhpc3Q7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgc3dpdGNoIHRvIGNoaWxkIGZyYW1lcycsIGFzeW5jICgpID0+IHtcbiAgICBhd2FpdCBkcml2ZXIuc2V0RnJhbWUoJ3RoaXJkJyk7XG4gICAgKGF3YWl0IGRyaXZlci50aXRsZSgpKS5zaG91bGQuYmUuZXF1YWwoJ0ZyYW1lc2V0IGd1aW5lYSBwaWcnKTtcblxuICAgIGF3YWl0IGRyaXZlci5zZXRGcmFtZSgnY2hpbGRmcmFtZScpO1xuICAgIChhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ2lkJywgJ29ubHlfb25fcGFnZV8yJykpLnNob3VsZC5leGlzdDtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBleGVjdXRlIGphdmFzY3JpcHQgaW4gZnJhbWUnLCBhc3luYyAoKSA9PiB7XG4gICAgYXdhaXQgZHJpdmVyLnNldEZyYW1lKCdmaXJzdCcpO1xuICAgIChhd2FpdCBkcml2ZXIuZXhlY3V0ZShHRVRfRUxFTV9TWU5DKSkuc2hvdWxkLmJlLmVxdWFsKCdTdWIgZnJhbWUgMScpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIGV4ZWN1dGUgYXN5bmMgamF2YXNjcmlwdCBpbiBmcmFtZScsIGFzeW5jICgpID0+IHtcbiAgICBhd2FpdCBkcml2ZXIuc2V0RnJhbWUoJ2ZpcnN0Jyk7XG4gICAgKGF3YWl0IGRyaXZlci5leGVjdXRlQXN5bmMoR0VUX0VMRU1fQVNZTkMpKS5zaG91bGQuYmUuZXF1YWwoJ1N1YiBmcmFtZSAxJyk7XG4gIH0pO1xufSk7XG4iXX0=