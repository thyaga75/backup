'use strict';

var _regeneratorRuntime = require('babel-runtime/regenerator')['default'];

var _interopRequireDefault = require('babel-runtime/helpers/interop-require-default')['default'];

var _desired = require('./desired');

var _desired2 = _interopRequireDefault(_desired);

var _setupBase = require('../../setup-base');

var _setupBase2 = _interopRequireDefault(_setupBase);

var _helpersWebview = require('../../helpers/webview');

describe('safari - webview - alerts @skip-real-device', function () {
  var _this = this;

  var driver = (0, _setupBase2['default'])(this, _desired2['default'], { 'no-reset': true }).driver;
  beforeEach(function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap((0, _helpersWebview.loadWebView)(_desired2['default'], driver));

        case 2:
          return context$2$0.abrupt('return', context$2$0.sent);

        case 3:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });

  it('should accept alert', function callee$1$0() {
    var el;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.findElement('id', 'alert1'));

        case 2:
          el = context$2$0.sent;
          context$2$0.next = 5;
          return _regeneratorRuntime.awrap(driver.click(el));

        case 5:
          context$2$0.next = 7;
          return _regeneratorRuntime.awrap(driver.postAcceptAlert());

        case 7:
          context$2$0.next = 9;
          return _regeneratorRuntime.awrap(driver.title());

        case 9:
          context$2$0.sent.should.include('I am a page title');

        case 10:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });

  it('should dismiss alert', function callee$1$0() {
    var el;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.findElement('id', 'alert1'));

        case 2:
          el = context$2$0.sent;
          context$2$0.next = 5;
          return _regeneratorRuntime.awrap(driver.click(el));

        case 5:
          context$2$0.next = 7;
          return _regeneratorRuntime.awrap(driver.postDismissAlert());

        case 7:
          context$2$0.next = 9;
          return _regeneratorRuntime.awrap(driver.title());

        case 9:
          context$2$0.sent.should.include('I am a page title');

        case 10:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });

  it('should get text of alert', function callee$1$0() {
    var el;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.findElement('id', 'alert1'));

        case 2:
          el = context$2$0.sent;
          context$2$0.next = 5;
          return _regeneratorRuntime.awrap(driver.click(el));

        case 5:
          context$2$0.next = 7;
          return _regeneratorRuntime.awrap(driver.getAlertText());

        case 7:
          context$2$0.sent.should.include('I am an alert');
          context$2$0.next = 10;
          return _regeneratorRuntime.awrap(driver.postDismissAlert());

        case 10:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });

  it('should not get text of alert that closed', function callee$1$0() {
    var el;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.findElement('id', 'alert1'));

        case 2:
          el = context$2$0.sent;
          context$2$0.next = 5;
          return _regeneratorRuntime.awrap(driver.click(el));

        case 5:
          context$2$0.next = 7;
          return _regeneratorRuntime.awrap(driver.postAcceptAlert());

        case 7:
          return context$2$0.abrupt('return', driver.getAlertText().should.be.rejectedWith(/An attempt was made to operate on a modal dialog when one was not open/));

        case 8:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });

  it('should set text of prompt', function callee$1$0() {
    var el;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.findElement('id', 'prompt1'));

        case 2:
          el = context$2$0.sent;
          context$2$0.next = 5;
          return _regeneratorRuntime.awrap(driver.click(el));

        case 5:
          context$2$0.next = 7;
          return _regeneratorRuntime.awrap(driver.setAlertText('yes I do!'));

        case 7:
          context$2$0.next = 9;
          return _regeneratorRuntime.awrap(driver.postAcceptAlert());

        case 9:
          context$2$0.next = 11;
          return _regeneratorRuntime.awrap(driver.findElement('id', 'promptVal'));

        case 11:
          el = context$2$0.sent;
          context$2$0.next = 14;
          return _regeneratorRuntime.awrap(driver.getAttribute('value', el));

        case 14:
          context$2$0.sent.toLowerCase().should.equal('yes i do!');

        case 15:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });

  it('should fail to set text of alert', function callee$1$0() {
    var el;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.findElement('id', 'alert1'));

        case 2:
          el = context$2$0.sent;
          context$2$0.next = 5;
          return _regeneratorRuntime.awrap(driver.click(el));

        case 5:
          return context$2$0.abrupt('return', driver.setAlertText('yes I do!').should.be.rejectedWith(/Tried to set text of an alert that wasn't a prompt/));

        case 6:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
});

// TODO: avoiding flaky test case where value is 'yes I dO'.
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3QvZTJlL3NhZmFyaS93ZWJ2aWV3L2FsZXJ0cy1zcGVjcy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7dUJBQW9CLFdBQVc7Ozs7eUJBQ2Isa0JBQWtCOzs7OzhCQUNSLHVCQUF1Qjs7QUFFbkQsUUFBUSxDQUFDLDZDQUE2QyxFQUFFLFlBQVc7OztBQUNqRSxNQUFNLE1BQU0sR0FBRyw0QkFBTSxJQUFJLHdCQUFXLEVBQUMsVUFBVSxFQUFFLElBQUksRUFBQyxDQUFDLENBQUMsTUFBTSxDQUFDO0FBQy9ELFlBQVUsQ0FBQzs7Ozs7MkNBQWtCLHVEQUFxQixNQUFNLENBQUM7Ozs7Ozs7Ozs7R0FBQSxDQUFDLENBQUM7O0FBRTNELElBQUUsQ0FBQyxxQkFBcUIsRUFBRTtRQUNwQixFQUFFOzs7OzsyQ0FBUyxNQUFNLENBQUMsV0FBVyxDQUFDLElBQUksRUFBRSxRQUFRLENBQUM7OztBQUE3QyxZQUFFOzsyQ0FDQSxNQUFNLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQzs7OzsyQ0FDaEIsTUFBTSxDQUFDLGVBQWUsRUFBRTs7OzsyQ0FDdkIsTUFBTSxDQUFDLEtBQUssRUFBRTs7OzJCQUFFLE1BQU0sQ0FBQyxPQUFPLENBQUMsbUJBQW1COzs7Ozs7O0dBQzFELENBQUMsQ0FBQzs7QUFFSCxJQUFFLENBQUMsc0JBQXNCLEVBQUU7UUFDckIsRUFBRTs7Ozs7MkNBQVMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxJQUFJLEVBQUUsUUFBUSxDQUFDOzs7QUFBN0MsWUFBRTs7MkNBQ0EsTUFBTSxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUM7Ozs7MkNBQ2hCLE1BQU0sQ0FBQyxnQkFBZ0IsRUFBRTs7OzsyQ0FDeEIsTUFBTSxDQUFDLEtBQUssRUFBRTs7OzJCQUFFLE1BQU0sQ0FBQyxPQUFPLENBQUMsbUJBQW1COzs7Ozs7O0dBQzFELENBQUMsQ0FBQzs7QUFFSCxJQUFFLENBQUMsMEJBQTBCLEVBQUU7UUFDekIsRUFBRTs7Ozs7MkNBQVMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxJQUFJLEVBQUUsUUFBUSxDQUFDOzs7QUFBN0MsWUFBRTs7MkNBQ0EsTUFBTSxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUM7Ozs7MkNBQ2YsTUFBTSxDQUFDLFlBQVksRUFBRTs7OzJCQUFFLE1BQU0sQ0FBQyxPQUFPLENBQUMsZUFBZTs7MkNBQ3RELE1BQU0sQ0FBQyxnQkFBZ0IsRUFBRTs7Ozs7OztHQUNoQyxDQUFDLENBQUM7O0FBRUgsSUFBRSxDQUFDLDBDQUEwQyxFQUFFO1FBQ3pDLEVBQUU7Ozs7OzJDQUFTLE1BQU0sQ0FBQyxXQUFXLENBQUMsSUFBSSxFQUFFLFFBQVEsQ0FBQzs7O0FBQTdDLFlBQUU7OzJDQUNBLE1BQU0sQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDOzs7OzJDQUNoQixNQUFNLENBQUMsZUFBZSxFQUFFOzs7OENBQ3ZCLE1BQU0sQ0FBQyxZQUFZLEVBQUUsQ0FDekIsTUFBTSxDQUFDLEVBQUUsQ0FBQyxZQUFZLENBQUMsd0VBQXdFLENBQUM7Ozs7Ozs7R0FDcEcsQ0FBQyxDQUFDOztBQUVILElBQUUsQ0FBQywyQkFBMkIsRUFBRTtRQUMxQixFQUFFOzs7OzsyQ0FBUyxNQUFNLENBQUMsV0FBVyxDQUFDLElBQUksRUFBRSxTQUFTLENBQUM7OztBQUE5QyxZQUFFOzsyQ0FDQSxNQUFNLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQzs7OzsyQ0FDaEIsTUFBTSxDQUFDLFlBQVksQ0FBQyxXQUFXLENBQUM7Ozs7MkNBQ2hDLE1BQU0sQ0FBQyxlQUFlLEVBQUU7Ozs7MkNBRW5CLE1BQU0sQ0FBQyxXQUFXLENBQUMsSUFBSSxFQUFFLFdBQVcsQ0FBQzs7O0FBQWhELFlBQUU7OzJDQUVLLE1BQU0sQ0FBQyxZQUFZLENBQUMsT0FBTyxFQUFFLEVBQUUsQ0FBQzs7OzJCQUFFLFdBQVcsR0FBRyxNQUFNLENBQUMsS0FBSyxDQUFDLFdBQVc7Ozs7Ozs7R0FDaEYsQ0FBQyxDQUFDOztBQUVILElBQUUsQ0FBQyxrQ0FBa0MsRUFBRTtRQUNqQyxFQUFFOzs7OzsyQ0FBUyxNQUFNLENBQUMsV0FBVyxDQUFDLElBQUksRUFBRSxRQUFRLENBQUM7OztBQUE3QyxZQUFFOzsyQ0FDQSxNQUFNLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQzs7OzhDQUNmLE1BQU0sQ0FBQyxZQUFZLENBQUMsV0FBVyxDQUFDLENBQ3BDLE1BQU0sQ0FBQyxFQUFFLENBQUMsWUFBWSxDQUFDLG9EQUFvRCxDQUFDOzs7Ozs7O0dBQ2hGLENBQUMsQ0FBQztDQUNKLENBQUMsQ0FBQyIsImZpbGUiOiJ0ZXN0L2UyZS9zYWZhcmkvd2Vidmlldy9hbGVydHMtc3BlY3MuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZGVzaXJlZCBmcm9tICcuL2Rlc2lyZWQnO1xuaW1wb3J0IHNldHVwIGZyb20gJy4uLy4uL3NldHVwLWJhc2UnO1xuaW1wb3J0IHsgbG9hZFdlYlZpZXcgfSBmcm9tICcuLi8uLi9oZWxwZXJzL3dlYnZpZXcnO1xuXG5kZXNjcmliZSgnc2FmYXJpIC0gd2VidmlldyAtIGFsZXJ0cyBAc2tpcC1yZWFsLWRldmljZScsIGZ1bmN0aW9uKCkge1xuICBjb25zdCBkcml2ZXIgPSBzZXR1cCh0aGlzLCBkZXNpcmVkLCB7J25vLXJlc2V0JzogdHJ1ZX0pLmRyaXZlcjtcbiAgYmVmb3JlRWFjaChhc3luYyAoKSA9PiBhd2FpdCBsb2FkV2ViVmlldyhkZXNpcmVkLCBkcml2ZXIpKTtcblxuICBpdCgnc2hvdWxkIGFjY2VwdCBhbGVydCcsIGFzeW5jICgpID0+IHtcbiAgICBsZXQgZWwgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ2lkJywgJ2FsZXJ0MScpO1xuICAgIGF3YWl0IGRyaXZlci5jbGljayhlbCk7XG4gICAgYXdhaXQgZHJpdmVyLnBvc3RBY2NlcHRBbGVydCgpO1xuICAgIChhd2FpdCBkcml2ZXIudGl0bGUoKSkuc2hvdWxkLmluY2x1ZGUoJ0kgYW0gYSBwYWdlIHRpdGxlJyk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgZGlzbWlzcyBhbGVydCcsIGFzeW5jICgpID0+IHtcbiAgICBsZXQgZWwgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ2lkJywgJ2FsZXJ0MScpO1xuICAgIGF3YWl0IGRyaXZlci5jbGljayhlbCk7XG4gICAgYXdhaXQgZHJpdmVyLnBvc3REaXNtaXNzQWxlcnQoKTtcbiAgICAoYXdhaXQgZHJpdmVyLnRpdGxlKCkpLnNob3VsZC5pbmNsdWRlKCdJIGFtIGEgcGFnZSB0aXRsZScpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIGdldCB0ZXh0IG9mIGFsZXJ0JywgYXN5bmMgKCkgPT4ge1xuICAgIGxldCBlbCA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgnaWQnLCAnYWxlcnQxJyk7XG4gICAgYXdhaXQgZHJpdmVyLmNsaWNrKGVsKTtcbiAgICAoYXdhaXQgZHJpdmVyLmdldEFsZXJ0VGV4dCgpKS5zaG91bGQuaW5jbHVkZSgnSSBhbSBhbiBhbGVydCcpO1xuICAgIGF3YWl0IGRyaXZlci5wb3N0RGlzbWlzc0FsZXJ0KCk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgbm90IGdldCB0ZXh0IG9mIGFsZXJ0IHRoYXQgY2xvc2VkJywgYXN5bmMgKCkgPT4ge1xuICAgIGxldCBlbCA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgnaWQnLCAnYWxlcnQxJyk7XG4gICAgYXdhaXQgZHJpdmVyLmNsaWNrKGVsKTtcbiAgICBhd2FpdCBkcml2ZXIucG9zdEFjY2VwdEFsZXJ0KCk7XG4gICAgcmV0dXJuIGRyaXZlci5nZXRBbGVydFRleHQoKVxuICAgICAgLnNob3VsZC5iZS5yZWplY3RlZFdpdGgoL0FuIGF0dGVtcHQgd2FzIG1hZGUgdG8gb3BlcmF0ZSBvbiBhIG1vZGFsIGRpYWxvZyB3aGVuIG9uZSB3YXMgbm90IG9wZW4vKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBzZXQgdGV4dCBvZiBwcm9tcHQnLCBhc3luYyAoKSA9PiB7XG4gICAgbGV0IGVsID0gYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50KCdpZCcsICdwcm9tcHQxJyk7XG4gICAgYXdhaXQgZHJpdmVyLmNsaWNrKGVsKTtcbiAgICBhd2FpdCBkcml2ZXIuc2V0QWxlcnRUZXh0KCd5ZXMgSSBkbyEnKTtcbiAgICBhd2FpdCBkcml2ZXIucG9zdEFjY2VwdEFsZXJ0KCk7XG5cbiAgICBlbCA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgnaWQnLCAncHJvbXB0VmFsJyk7XG4gICAgLy8gVE9ETzogYXZvaWRpbmcgZmxha3kgdGVzdCBjYXNlIHdoZXJlIHZhbHVlIGlzICd5ZXMgSSBkTycuXG4gICAgKGF3YWl0IGRyaXZlci5nZXRBdHRyaWJ1dGUoJ3ZhbHVlJywgZWwpKS50b0xvd2VyQ2FzZSgpLnNob3VsZC5lcXVhbCgneWVzIGkgZG8hJyk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgZmFpbCB0byBzZXQgdGV4dCBvZiBhbGVydCcsIGFzeW5jICgpID0+IHtcbiAgICBsZXQgZWwgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ2lkJywgJ2FsZXJ0MScpO1xuICAgIGF3YWl0IGRyaXZlci5jbGljayhlbCk7XG4gICAgcmV0dXJuIGRyaXZlci5zZXRBbGVydFRleHQoJ3llcyBJIGRvIScpXG4gICAgICAuc2hvdWxkLmJlLnJlamVjdGVkV2l0aCgvVHJpZWQgdG8gc2V0IHRleHQgb2YgYW4gYWxlcnQgdGhhdCB3YXNuJ3QgYSBwcm9tcHQvKTtcbiAgfSk7XG59KTtcbiJdfQ==